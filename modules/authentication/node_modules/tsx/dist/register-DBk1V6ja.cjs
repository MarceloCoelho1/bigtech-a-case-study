"use strict";var W=Object.defineProperty;var o=(e,s)=>W(e,"name",{value:s,configurable:!0});var C=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),u=require("node:path"),O=require("node:url"),y=require("get-tsconfig"),J=require("node:fs"),v=require("./index-CoHsQGpm.cjs"),S=require("./client-D6NvIMSC.cjs");const x=Object.create(null);x[".js"]=[".ts",".tsx",".js",".jsx"],x[".jsx"]=[".tsx",".ts",".jsx",".js"],x[".cjs"]=[".cts"],x[".mjs"]=[".mts"];const T=o(e=>{const[s,t]=e.split("?"),r=u.extname(s),c=x[r];if(!c)return;const n=s.slice(0,-r.length);return c.map(a=>n+a+(t?`?${t}`:""))},"mapTsExtensions"),I=o(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),b=o(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),Q=o(e=>b(e)||u.isAbsolute(e),"isUnixPath"),k=o(e=>{if(Q(e))return!0;const s=I(e);return s&&s!=="node"},"requestAcceptsQuery"),R="file://",U=/\.([cm]?ts|[tj]sx)($|\?)/,B=/\.json($|\?)/,z=/\/(?:$|\?)/,G=/^(?:@[^/]+\/)?[^/]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const w=o(e=>{let s=null;if(e){const t=u.resolve(e);s={path:t,config:y.parseTsconfig(t)}}else{try{s=y.getTsconfig()}catch{}if(!s)return}exports.fileMatcher=y.createFilesMatcher(s),exports.tsconfigPathsMatcher=y.createPathsMatcher(s),exports.allowJs=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),E=o(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),L=[".ts",".tsx",".jsx"],$=o((e,...s)=>{for(const t of L)try{return s[0]+=t,e(...s)}catch{}},"tryExtensions"),H=o(e=>(s,...t)=>{try{return e(s,...t)}catch(r){const c=r;if(c.code==="MODULE_NOT_FOUND"){const n=$(e,s,...t)||$(e,`${s}${u.sep}index`,...t);if(n)return n}throw c}},"createImplicitResolver"),X=`${u.sep}node_modules${u.sep}`,F=o(e=>{if(!e.startsWith("data:text/javascript,"))return;const s=e.indexOf("?");if(s===-1)return;const r=new URLSearchParams(e.slice(s+1)).get("filePath");if(r)return r},"getOriginalFilePath"),N=o(e=>{const s=F(e);return s&&(d._cache[s]=d._cache[e],delete d._cache[e],e=s),e},"interopCjsExports"),j=o((e,s,t)=>{if(!(t?.filename&&U.test(t.filename))&&!exports.allowJs)return;const r=T(s);if(r)for(const c of r)try{return e(c)}catch(n){const{code:a}=n;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw n}},"resolveTsFilename"),K=o((e,s,t)=>{if(e.startsWith(R)&&(e=O.fileURLToPath(e)),exports.tsconfigPathsMatcher&&!b(e)&&!s?.filename?.includes(X)){const c=exports.tsconfigPathsMatcher(e);for(const n of c){const a=j(t,n,s);if(a)return a;try{return t(n)}catch{}}}const r=j(t,e,s);if(r)return r;try{return t(e)}catch(c){const n=c;if(n.code==="MODULE_NOT_FOUND"&&typeof n.path=="string"&&n.path.endsWith(`${u.sep}package.json`)){const a=n.message.match(/^Cannot find module '([^']+)'$/);if(a){const m=a[1],l=j(t,m,s);if(l)return l}const i=n.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const m=i[1],l=j(t,m,s);if(l)return l}}throw n}},"resolveRequest"),q=o((e,s)=>(s&&(e=H(e)),(t,r,c,n)=>{const a=o(h=>e(h,r,c,n),"resolve");if(t=N(t),r?.filename){const h=F(r.filename);h&&(r.filename=h.split("?")[0])}const i=t.split("?"),m=new URLSearchParams(i[1]);if(r?.filename){const P=new URLSearchParams(r.filename.split("?")[1]).get("namespace");P&&m.append("namespace",P)}if((m.get("namespace")??void 0)!==s)return a(t);let l=K(i[0],r,a);return u.isAbsolute(l)&&!l.endsWith(".json")&&!l.endsWith(".node")&&(l+=E(m)),l}),"createResolveFilename"),V=`
//# sourceMappingURL=data:application/json;base64,`,A=o(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),_=o(({code:e,map:s})=>e+V+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),Y=[".cts",".mts",".ts",".tsx",".jsx"],Z=[".js",".cjs",".mjs"],ee=o((e,s)=>{const t=Object.assign(Object.create(null),e),r=t[".js"],c=o((n,a)=>{const[i,m]=a.split("?");if((new URLSearchParams(m).get("namespace")??void 0)!==s)return r(n,i);S.parent?.send&&S.parent.send({type:"dependency",path:i});const h=Y.some(f=>i.endsWith(f)),P=Z.some(f=>i.endsWith(f));if(!h&&!P)return r(n,i);let p=J.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=v.transformDynamicImport(a,p);f&&(p=A()?_(f):f.code)}else if(h||v.isESM(p)){const f=v.transformSync(p,a,{tsconfigRaw:exports.fileMatcher?.(i)});p=A()?_(f):f.code}n._compile(p,i)},"transformer");t[".js"]=c;for(const n of L){const a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(t,n,{value:c,enumerable:a?.enumerable||!s})}return Object.defineProperty(t,".mjs",{value:c,enumerable:!1}),t},"createExtensions"),D=o((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof s=="string"&&s.startsWith("file://")||s instanceof URL)&&(s=O.fileURLToPath(s)),u.resolve(u.dirname(s),e)},"resolveContext"),se=o(e=>{const{sourceMapsEnabled:s}=process,{_extensions:t,_resolveFilename:r}=d;w(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const c=q(r,e?.namespace);d._resolveFilename=c;const n=ee(d._extensions,e?.namespace);d._extensions=n;const a=o(()=>{s===!1&&process.setSourceMapsEnabled(!1),d._extensions=t,d._resolveFilename=r},"unregister");if(e?.namespace){const i=o((l,h)=>{const P=D(l,h),[p,f]=P.split("?"),g=new URLSearchParams(f);return e.namespace&&g.set("namespace",e.namespace),C.require(p+E(g))},"scopedRequire");a.require=i;const m=o((l,h,P)=>{const p=D(l,h),[f,g]=p.split("?"),M=new URLSearchParams(g);return e.namespace&&M.set("namespace",e.namespace),c(f+E(M),module,!1,P)},"scopedResolve");a.resolve=m,a.unregister=a}return a},"register");exports.fileUrlPrefix=R,exports.inlineSourceMap=_,exports.interopCjsExports=N,exports.isBarePackageName=G,exports.isDirectoryPattern=z,exports.isJsonPattern=B,exports.loadTsconfig=w,exports.mapTsExtensions=T,exports.register=se,exports.requestAcceptsQuery=k,exports.tsExtensionsPattern=U;
